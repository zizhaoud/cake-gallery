<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”»å†Œç®¡ç† - å¹¸ç¦è¥¿é¥¼å¤§æœ›åº—</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
        }
        body { 
            background-color: #f9f5f0; 
            color: #5d4037; 
            line-height: 1.6; 
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        header { 
            background: linear-gradient(135deg, #5d4037, #4a3429); 
            color: #ffcdd2; 
            text-align: center; 
            padding: 2rem 1rem; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        h1 { 
            font-size: 2.5rem; 
            margin-bottom: 0.5rem; 
        }
        .subtitle { 
            font-size: 1.2rem; 
            opacity: 0.8; 
        }
        
        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .management-container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 2rem 1rem; 
        }
        
        /* è¿”å›æŒ‰é’® */
        .back-btn {
            background: #ffcdd2;
            color: #5d4037;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 2rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: #f8bbd0;
            transform: translateX(-5px);
        }
        
        /* ç®¡ç†åŠŸèƒ½åŒºåŸŸ */
        .management-section {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: 20px;
            padding: 2.5rem;
            margin-top: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 1px solid #f0f0f0;
            position: relative;
            overflow: hidden;
        }

        .management-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffcdd2, #f8bbd0, #ffcdd2);
        }

        .management-header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #f0f0f0;
            position: relative;
        }

        .management-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 2px;
            background: linear-gradient(90deg, #ffcdd2, #f8bbd0);
        }

        .management-header h2 {
            color: #5d4037;
            font-size: 1.8rem;
            margin-bottom: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .management-header p {
            color: #8d6e63;
            font-size: 1rem;
            line-height: 1.5;
            max-width: 500px;
            margin: 0 auto;
        }

        .management-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .management-card {
            background: white;
            border-radius: 16px;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            border: 1px solid #f8f9fa;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .management-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffcdd2, #f8bbd0);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .management-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.12);
        }

        .management-card:hover::before {
            transform: scaleX(1);
        }

        .management-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
            transition: transform 0.3s ease;
        }

        .management-card:hover .management-icon {
            transform: scale(1.1);
        }

        .management-card h3 {
            color: #5d4037;
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }

        .management-card p {
            color: #8d6e63;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
            min-height: 40px;
        }

        .management-btn {
            width: 100%;
            background: linear-gradient(135deg, #5d4037, #4a3429);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .management-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .management-btn:hover {
            background: linear-gradient(135deg, #4a3429, #3d2b21);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(93, 64, 55, 0.3);
        }

        .management-btn:hover::before {
            left: 100%;
        }

        .stats-section {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 16px;
            padding: 2.5rem 2rem;
            text-align: center;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
            position: relative;
            overflow: hidden;
        }

        .stats-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1%, transparent 1%);
            background-size: 20px 20px;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-20px, -20px) rotate(360deg); }
        }

        .stats-section h3 {
            margin-bottom: 1rem;
            font-size: 1.4rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .stats-section p {
            margin-bottom: 1.5rem;
            font-size: 1rem;
            line-height: 1.5;
            opacity: 0.9;
            position: relative;
            z-index: 1;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .stats-btn-large {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.5);
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
        }

        .stats-btn-large:hover {
            background: white;
            color: #4CAF50;
            border-color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255,255,255,0.3);
        }

        /* é¡µè„š */
        footer { 
            text-align: center; 
            padding: 2rem; 
            background-color: #5d4037; 
            color: #ffcdd2; 
            margin-top: 2rem; 
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .management-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .management-section {
                padding: 2rem 1.5rem;
                margin-top: 2rem;
            }
            
            .management-card {
                padding: 1.5rem 1rem;
            }
            
            .stats-section {
                padding: 2rem 1.5rem;
            }
            
            .management-header h2 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .management-section {
                padding: 1.5rem 1rem;
            }
            
            .management-card {
                padding: 1.2rem 0.8rem;
            }
            
            .stats-section {
                padding: 1.5rem 1rem;
            }
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 102;
            justify-content: center;
            align-items: center;
        }
        .password-form {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        .password-input {
            width: 100%;
            padding: 0.75rem;
            margin: 1rem 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 1rem;
        }
        .save-btn, .cancel-btn, .delete-confirm-btn, .stats-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .save-btn {
            background: #ffcdd2;
            color: #5d4037;
        }
        .cancel-btn {
            background: #ddd;
            color: #666;
        }
        .delete-confirm-btn {
            background: #e91e63;
            color: white;
        }
        .stats-btn {
            background: #4CAF50;
            color: white;
        }

        /* æ¸…ç†æ•°æ®æ¨¡æ€æ¡† */
        .cleanup-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 103;
            justify-content: center;
            align-items: center;
        }
        .cleanup-form {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .cleanup-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .cleanup-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .cleanup-item:last-child {
            border-bottom: none;
        }
        .cleanup-item input {
            margin-right: 10px;
        }
        .cleanup-item-info {
            flex: 1;
        }
        .cleanup-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .cleanup-item-details {
            font-size: 0.8rem;
            color: #666;
        }

        /* ç»Ÿè®¡æ¨¡æ€æ¡† */
        .stats-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 104;
            justify-content: center;
            align-items: center;
        }
        .stats-form {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .stat-card {
            background: #f9f5f0;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #e91e63;
            margin-bottom: 0.5rem;
        }
        .stat-label {
            font-size: 0.9rem;
            color: #8d6e63;
        }
        .stats-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .stats-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .stats-item:last-child {
            border-bottom: none;
        }
        .stats-item-name {
            font-weight: bold;
            flex: 1;
        }
        .stats-item-views {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        .popular-tag {
            background: #ff9800;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <header>
        <h1>å¹¸ç¦è¥¿é¥¼å¤§æœ›åº— - ç”»å†Œç®¡ç†</h1>
        <p class="subtitle">âœ¨âœ¨æ¬¢è¿å…‰ä¸´âœ¨âœ¨é¡¾å®¢è¯·ç‚¹å‡»ã€è¿”å›ç”»å†Œæµè§ˆã€‘ç»§ç»­é€‰è´­é’Ÿæ„çš„è›‹ç³•ğŸ‚æ„Ÿè°¢ğŸ˜Š</p>
    </header>
    
    <div class="management-container">
        <button class="back-btn" onclick="gotoMainPage()">â† è¿”å›ç”»å†Œæµè§ˆ</button>
        
        <!-- ç®¡ç†åŠŸèƒ½åŒºåŸŸ -->
        <div class="management-section">
            <div class="management-header">
                <h2>ğŸ“Š ç”»å†Œç®¡ç†ç³»ç»Ÿ</h2>
                <p>è¯·é¡¾å®¢ç‚¹å‡»ç²‰è‰²æŒ‰é’®è¿”å›ç”»å†Œæµè§ˆğŸ‚æœ¬é¡µé¢ä¸ºè€æ¿çš„é«˜çº§ç®¡ç†åŠŸèƒ½ï¼Œç¥æ‚¨é€‰è´­æ„‰å¿«ğŸ˜Š</p>
            </div>
            
            <div class="management-grid">
                <div class="management-card">
                    <div class="management-icon">ğŸ“¤</div>
                    <h3>å¯¼å…¥æ•°æ®</h3>
                    <p>ä»å¤‡ä»½æ–‡ä»¶æ¢å¤è›‹ç³•æ•°æ®ï¼Œå¿«é€Ÿé‡å»ºç”»å†Œå†…å®¹</p>
                    <button class="management-btn" onclick="showPasswordModal('import')">å¯¼å…¥æ•°æ®</button>
                </div>
                
                <div class="management-card">
                    <div class="management-icon">ğŸ“¥</div>
                    <h3>å¯¼å‡ºæ•°æ®</h3>
                    <p>å¤‡ä»½æ‰€æœ‰è›‹ç³•æ•°æ®åˆ°æœ¬åœ°ï¼Œé˜²æ­¢æ„å¤–æ•°æ®ä¸¢å¤±</p>
                    <button class="management-btn" onclick="showPasswordModal('export')">å¯¼å‡ºæ•°æ®</button>
                </div>
                
                <div class="management-card">
                    <div class="management-icon">ğŸ”„</div>
                    <h3>é‡ç½®å›¾å†Œ</h3>
                    <p>æ¢å¤å›¾å†Œåˆ°åˆå§‹çŠ¶æ€ï¼Œæ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰å†…å®¹</p>
                    <button class="management-btn" onclick="showPasswordModal('reset')">é‡ç½®å›¾å†Œ</button>
                </div>
                
                <div class="management-card">
                    <div class="management-icon">ğŸ—‘ï¸</div>
                    <h3>æ¸…ç†å›¾å†Œ</h3>
                    <p>æ‰¹é‡åˆ é™¤ä¸éœ€è¦çš„è›‹ç³•ï¼Œä¿æŒç”»å†Œæ•´æ´æœ‰åº</p>
                    <button class="management-btn" onclick="showPasswordModal('cleanup')">æ¸…ç†å›¾å†Œ</button>
                </div>
            </div>
            
            <div class="stats-section">
                <h3>ğŸ“ˆ æŸ¥çœ‹è›‹ç³•æµè§ˆç»Ÿè®¡</h3>
                <p>æ·±å…¥äº†è§£é¡¾å®¢å–œå¥½ï¼ŒæŸ¥çœ‹å„è›‹ç³•çš„æµè§ˆé‡æ•°æ®ï¼Œä¼˜åŒ–äº§å“å±•ç¤ºç­–ç•¥</p>
                <button class="stats-btn-large" onclick="showPasswordModal('stats')">æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡</button>
            </div>
            
            <input type="file" id="dataImport" accept=".json" style="display: none;">
        </div>
    </div>

    <!-- å¯†ç ç¡®è®¤æ¨¡æ€æ¡† -->
    <div class="password-modal" id="passwordModal">
        <div class="password-form">
            <h3>è¯·è¾“å…¥ç®¡ç†å¯†ç </h3>
            <input type="password" class="password-input" id="passwordInput" placeholder="è¾“å…¥å¯†ç ">
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelPassword">å–æ¶ˆ</button>
                <button class="save-btn" id="confirmPassword">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- æ¸…ç†æ•°æ®æ¨¡æ€æ¡† -->
    <div class="cleanup-modal" id="cleanupModal">
        <div class="cleanup-form">
            <h3>æ¸…ç†æ•°æ®</h3>
            <p>è¯·é€‰æ‹©è¦åˆ é™¤çš„è›‹ç³•ï¼ˆå‹¾é€‰åç‚¹å‡»ç¡®è®¤åˆ é™¤ï¼‰ï¼š</p>
            <div class="cleanup-list" id="cleanupList">
                <!-- æ¸…ç†åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelCleanup">å–æ¶ˆ</button>
                <button class="delete-confirm-btn" id="confirmCleanup">ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
    </div>

    <!-- ç»Ÿè®¡æ¨¡æ€æ¡† -->
    <div class="stats-modal" id="statsModal">
        <div class="stats-form">
            <h3>è›‹ç³•æµè§ˆç»Ÿè®¡</h3>
            <div class="stats-summary" id="statsSummary">
                <!-- ç»Ÿè®¡æ‘˜è¦å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <h4>è¯¦ç»†æµè§ˆæ•°æ®</h4>
            <div class="stats-list" id="statsList">
                <!-- ç»Ÿè®¡åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelStats">å…³é—­</button>
                <button class="stats-btn" onclick="resetStats()">é‡ç½®ç»Ÿè®¡</button>
            </div>
        </div>
    </div>
    
    <footer>
        <p>å¹¸ç¦è¥¿é¥¼å¤§æœ›åº— Â® 2025 | åœ°å€ï¼šæ·±åœ³å¸‚ç½—æ¹–åŒºå¤§æœ›ä¸­è·¯272å· | åº—æŒæŸœï¼šè¢è€æ¿ ç”µè¯ï¼š13714742290 | é«˜çº§è›‹ç³•å¸ˆå‚…ï¼šæ¬§é˜³å¥³å£« ç”µè¯ï¼š15817369662</p>
    </footer>

    <script>
        // è·³è½¬åˆ°ä¸»é¡µé¢
        function gotoMainPage() {
            window.location.href = 'index.html';
        }

        // åˆå§‹åŒ–è›‹ç³•æ•°æ®
        let cakes = [];
        let currentAction = null;
        const ADMIN_PASSWORD = "123456"; // ç»Ÿä¸€ç®¡ç†å¯†ç 

        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
        function loadFromLocalStorage() {
            const saved = localStorage.getItem('cakeCatalogData');
            if (saved) {
                const data = JSON.parse(saved);
                cakes = data.cakes || data; // å…¼å®¹æ—§ç‰ˆæœ¬æ•°æ®
                
                // åˆå§‹åŒ–æµè§ˆé‡æ•°æ®ï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
                cakes.forEach(cake => {
                    if (!cake.views) {
                        cake.views = 0;
                    }
                });
                saveToLocalStorage();
            } else {
                // é»˜è®¤æ•°æ®
                cakes = [
                    {
                        id: 1,
                        name: "è‰è“å¥¶æ²¹è›‹ç³•",
                        category: "birthday",
                        price: "Â¥168",
                        description: "æ–°é²œè‰è“ä¸é¦™ç”œå¥¶æ²¹çš„å®Œç¾ç»“åˆï¼Œå£æ„Ÿæ¸…æ–°ä¸è…»",
                        images: ["images/cake1.jpg"],
                        views: 0
                    },
                    {
                        id: 2,
                        name: "å·§å…‹åŠ›ç†”å²©è›‹ç³•",
                        category: "dessert",
                        price: "Â¥98",
                        description: "å¤–å±‚æ¾è½¯ï¼Œå†…é‡Œæµå¿ƒï¼Œæµ“éƒå·§å…‹åŠ›é£å‘³",
                        images: ["images/cake2.jpg"],
                        views: 0
                    },
                    {
                        id: 3,
                        name: "ä¸‰å±‚å©šç¤¼è›‹ç³•",
                        category: "wedding",
                        price: "Â¥888",
                        description: "ç²¾è‡´ä¼˜é›…çš„è®¾è®¡ï¼Œè±¡å¾æ°¸æ’çš„çˆ±æƒ…",
                        images: ["images/cake3.jpg"],
                        views: 0
                    }
                ];
                saveToLocalStorage();
            }
        }

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToLocalStorage() {
            localStorage.setItem('cakeCatalogData', JSON.stringify({ cakes, version: '2.0' }));
        }

        // æ˜¾ç¤ºå¯†ç æ¨¡æ€æ¡†
        function showPasswordModal(action) {
            currentAction = action;
            document.getElementById('passwordModal').style.display = 'flex';
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordInput').focus();
        }

        // å¯†ç éªŒè¯
        function verifyPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('passwordModal').style.display = 'none';
                executeAction();
            } else {
                alert('å¯†ç é”™è¯¯ï¼');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        // æ‰§è¡Œç®¡ç†æ“ä½œ
        function executeAction() {
            switch(currentAction) {
                case 'export':
                    exportData();
                    break;
                case 'import':
                    document.getElementById('dataImport').click();
                    break;
                case 'reset':
                    resetData();
                    break;
                case 'cleanup':
                    showCleanupModal();
                    break;
                case 'stats':
                    showStatsModal();
                    break;
            }
        }

        // æ˜¾ç¤ºæ¸…ç†æ•°æ®æ¨¡æ€æ¡†
        function showCleanupModal() {
            const cleanupList = document.getElementById('cleanupList');
            cleanupList.innerHTML = '';
            
            cakes.forEach(cake => {
                const cleanupItem = document.createElement('div');
                cleanupItem.className = 'cleanup-item';
                cleanupItem.innerHTML = `
                    <input type="checkbox" id="cleanup-${cake.id}" value="${cake.id}">
                    <div class="cleanup-item-info">
                        <div class="cleanup-item-name">${cake.name}</div>
                        <div class="cleanup-item-details">
                            åˆ†ç±»: ${getCategoryName(cake.category)} | ä»·æ ¼: ${cake.price} | 
                            æµè§ˆé‡: ${cake.views || 0} | å›¾ç‰‡æ•°é‡: ${cake.images ? cake.images.length : 0}
                        </div>
                    </div>
                `;
                cleanupList.appendChild(cleanupItem);
            });
            
            document.getElementById('cleanupModal').style.display = 'flex';
        }

        // è·å–åˆ†ç±»åç§°
        function getCategoryName(category) {
            const categoryNames = {
                'birthday': 'ç”Ÿæ—¥è›‹ç³•',
                'wedding': 'å©šç¤¼è›‹ç³•',
                'dessert': 'ç”œç‚¹è›‹ç³•',
                'seasonal': 'å­£èŠ‚é™å®š'
            };
            return categoryNames[category] || category;
        }

        // ç¡®è®¤æ¸…ç†æ•°æ®
        function confirmCleanup() {
            const checkboxes = document.querySelectorAll('#cleanupList input[type="checkbox"]:checked');
            const idsToDelete = Array.from(checkboxes).map(cb => parseInt(cb.value));
            
            if (idsToDelete.length === 0) {
                alert('è¯·é€‰æ‹©è¦åˆ é™¤çš„è›‹ç³•ï¼');
                return;
            }
            
            if (confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${idsToDelete.length} ä¸ªè›‹ç³•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)) {
                cakes = cakes.filter(cake => !idsToDelete.includes(cake.id));
                saveToLocalStorage();
                document.getElementById('cleanupModal').style.display = 'none';
                alert(`æˆåŠŸåˆ é™¤ ${idsToDelete.length} ä¸ªè›‹ç³•ï¼`);
            }
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const dataStr = JSON.stringify({ cakes, version: '2.0' }, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cake-catalog-backup.json';
            link.click();
            URL.revokeObjectURL(url);
            alert('æ•°æ®å¯¼å‡ºæˆåŠŸï¼');
        }

        // å¯¼å…¥æ•°æ®
        document.getElementById('dataImport').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        if (Array.isArray(importedData)) {
                            // å…¼å®¹æ—§ç‰ˆæœ¬æ•°æ®
                            cakes = importedData;
                        } else if (importedData.cakes) {
                            // æ–°ç‰ˆæœ¬æ•°æ®
                            cakes = importedData.cakes;
                        } else {
                            alert('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼');
                            return;
                        }
                        
                        // åˆå§‹åŒ–æµè§ˆé‡æ•°æ®
                        cakes.forEach(cake => {
                            if (!cake.views) {
                                cake.views = 0;
                            }
                        });
                        
                        saveToLocalStorage();
                        alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                    } catch (error) {
                        alert('æ–‡ä»¶è¯»å–å¤±è´¥ï¼');
                    }
                };
                reader.readAsText(file);
            }
        });

        // é‡ç½®æ•°æ®
        function resetData() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰çš„è›‹ç³•ä¿¡æ¯å’Œç»Ÿè®¡ï¼')) {
                localStorage.removeItem('cakeCatalogData');
                loadFromLocalStorage();
                alert('æ•°æ®å·²é‡ç½®ï¼');
            }
        }

        // æ˜¾ç¤ºç»Ÿè®¡æ¨¡æ€æ¡†
        function showStatsModal() {
            // è®¡ç®—ç»Ÿè®¡æ‘˜è¦
            const totalViews = cakes.reduce((sum, cake) => sum + (cake.views || 0), 0);
            const totalCakes = cakes.length;
            const avgViews = totalCakes > 0 ? Math.round(totalViews / totalCakes) : 0;
            const mostPopular = cakes.reduce((max, cake) => 
                (cake.views || 0) > (max.views || 0) ? cake : max, cakes[0]);
            
            // æ›´æ–°ç»Ÿè®¡æ‘˜è¦
            const statsSummary = document.getElementById('statsSummary');
            statsSummary.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalCakes}</div>
                    <div class="stat-label">è›‹ç³•æ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalViews}</div>
                    <div class="stat-label">æ€»æµè§ˆé‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${avgViews}</div>
                    <div class="stat-label">å¹³å‡æµè§ˆé‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${mostPopular ? mostPopular.views : 0}</div>
                    <div class="stat-label">æœ€é«˜æµè§ˆé‡</div>
                </div>
            `;
            
            // æ›´æ–°è¯¦ç»†ç»Ÿè®¡åˆ—è¡¨
            const statsList = document.getElementById('statsList');
            statsList.innerHTML = '';
            
            // æŒ‰æµè§ˆé‡æ’åº
            const sortedCakes = [...cakes].sort((a, b) => (b.views || 0) - (a.views || 0));
            
            sortedCakes.forEach((cake, index) => {
                const statsItem = document.createElement('div');
                statsItem.className = 'stats-item';
                const isPopular = index < 3 && cake.views > 0; // å‰ä¸‰åæ ‡è®°ä¸ºçƒ­é—¨
                statsItem.innerHTML = `
                    <div class="stats-item-name">
                        ${cake.name}
                        ${isPopular ? '<span class="popular-tag">çƒ­é—¨</span>' : ''}
                    </div>
                    <div class="stats-item-views">${cake.views || 0} æ¬¡æµè§ˆ</div>
                `;
                statsList.appendChild(statsItem);
            });
            
            document.getElementById('statsModal').style.display = 'flex';
        }

        // é‡ç½®ç»Ÿè®¡
        function resetStats() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æµè§ˆé‡ç»Ÿè®¡å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                cakes.forEach(cake => {
                    cake.views = 0;
                });
                saveToLocalStorage();
                showStatsModal(); // åˆ·æ–°ç»Ÿè®¡æ˜¾ç¤º
                alert('æµè§ˆé‡ç»Ÿè®¡å·²é‡ç½®ï¼');
            }
        }

        // åˆå§‹åŒ–ç®¡ç†é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            
            const passwordModal = document.getElementById('passwordModal');
            const cancelPassword = document.getElementById('cancelPassword');
            const confirmPassword = document.getElementById('confirmPassword');
            const cleanupModal = document.getElementById('cleanupModal');
            const cancelCleanup = document.getElementById('cancelCleanup');
            const confirmCleanup = document.getElementById('confirmCleanup');
            const statsModal = document.getElementById('statsModal');
            const cancelStats = document.getElementById('cancelStats');

            // å–æ¶ˆå¯†ç è¾“å…¥
            cancelPassword.addEventListener('click', function() {
                passwordModal.style.display = 'none';
                currentAction = null;
            });

            // ç¡®è®¤å¯†ç 
            confirmPassword.addEventListener('click', verifyPassword);
            
            // å–æ¶ˆæ¸…ç†
            cancelCleanup.addEventListener('click', function() {
                cleanupModal.style.display = 'none';
            });

            // ç¡®è®¤æ¸…ç†
            confirmCleanup.addEventListener('click', confirmCleanup);

            // å–æ¶ˆç»Ÿè®¡
            cancelStats.addEventListener('click', function() {
                statsModal.style.display = 'none';
            });
            
            // ç‚¹å‡»å¯†ç æ¨¡æ€çª—å£å¤–éƒ¨å…³é—­
            passwordModal.addEventListener('click', function(e) {
                if (e.target === passwordModal) {
                    passwordModal.style.display = 'none';
                    currentAction = null;
                }
            });

            // ç‚¹å‡»æ¸…ç†æ¨¡æ€çª—å£å¤–éƒ¨å…³é—­
            cleanupModal.addEventListener('click', function(e) {
                if (e.target === cleanupModal) {
                    cleanupModal.style.display = 'none';
                }
            });

            // ç‚¹å‡»ç»Ÿè®¡æ¨¡æ€çª—å£å¤–éƒ¨å…³é—­
            statsModal.addEventListener('click', function(e) {
                if (e.target === statsModal) {
                    statsModal.style.display = 'none';
                }
            });
        });
    </script>
</body>

</html>








